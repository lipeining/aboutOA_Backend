webpackJsonp([1],{"+1+n":function(e,t){},"4qN4":function(e,t){},"87Jk":function(e,t){},"8uk0":function(e,t){},GzwS:function(e,t){},"JHD/":function(e,t){},NHnr:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=r("MVMM"),a=r("9rMa"),n={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",{attrs:{id:"app"}},[t("router-view")],1)},staticRenderFns:[]};var s=r("Z0/y")({name:"App"},n,!1,function(e){r("RoUG")},null,null).exports,i=r("zO6J"),c=r("KH7x"),l=r.n(c),u=r("4YfN"),d=r.n(u),p=r("rVsN"),g=r.n(p),m=r("3cXf"),h=r.n(m);o.default.use(a.a);var f=new a.a.Store({state:{userInfo:{},isLogin:0},getters:{getUserInfo:function(e){return e.userInfo},isLogin:function(e){return e.isLogin||(e.isLogin=parseInt(localStorage.getItem("isLogin"))||0,e.userInfo=JSON.parse(localStorage.getItem("userInfo"))||{}),e.isLogin},isAdmin:function(e){e.isLogin||(e.isLogin=parseInt(localStorage.getItem("isLogin"))||0,e.userInfo=JSON.parse(localStorage.getItem("userInfo"))||{});var t=e.userInfo.permission||0;return e.isLogin&&90===t}},mutations:{setUserInfo:function(e,t){e.userInfo=t,e.isLogin=1,localStorage.setItem("userInfo",h()(t)),localStorage.setItem("isLogin",e.isLogin)},delUserInfo:function(e){e.userInfo={},e.isLogin=0,localStorage.removeItem("userInfo"),localStorage.removeItem("isLogin")}},actions:{setUserInfo:function(e,t){(0,e.commit)("setUserInfo",t)},delUserInfo:function(e){(0,e.commit)("delUserInfo")}}}),v=r("xH4k");function b(e){if(3===e.body.code)f.dispatch("delUserInfo"),Qe.push({name:"login"});else{if(5!==e.body.code)return 4===e.body.code?g.a.reject(e.body.Message.err):e.body.Message;Qe.push({name:"home"})}}function y(e,t){return v.get(e).query(t).then(function(e){return b(e)})}function _(e,t){return v.post(e).send(t).then(function(e){return b(e)})}function j(e,t){return v.put(e).send(t).then(function(e){return b(e)})}function x(e,t){return v.del(e).send(t).then(function(e){return b(e)})}var C=_.bind(null,"/api/v1/login"),w=_.bind(null,"/api/v1/reg"),k=y.bind(null,"/api/v1/logout"),P=y.bind(null,"/api/v1/captcha"),$=x.bind(null,"/api/v1/captcha"),I=j.bind(null,"/api/v1/user"),R=x.bind(null,"/api/v1/user"),F=y.bind(null,"/api/v1/users"),L=y.bind(null,"/api/v1/user"),Q=_.bind(null,"/api/v1/grant"),U={name:"app-header",computed:d()({},Object(a.b)({curUser:"getUserInfo",isAdmin:"isAdmin"})),data:function(){return{menuIndex:"1"}},created:function(){},methods:{logout:function(){var e=this;k({id:this.curUser.id}).then(function(t){e.$store.dispatch("delUserInfo"),e.$router.push({path:"/login"})}).catch(function(t){e.$store.dispatch("delUserInfo"),e.$router.push({path:"/login"})})}}},z={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("el-header",[r("el-menu",{attrs:{router:!0,"default-active":e.$route.path,mode:"horizontal","background-color":"#545c64","text-color":"#fff","active-text-color":"#ffd04b"}},[r("el-menu-item",{attrs:{index:"/home"}},[e._v(" Home")]),e._v(" "),e.isAdmin?r("el-menu-item",{attrs:{index:"/backend/users"}},[e._v(" Users")]):e._e(),e._v(" "),e.isAdmin?r("el-menu-item",{attrs:{index:"/backend/categories"}},[e._v(" Categories")]):e._e(),e._v(" "),e.isAdmin?r("el-menu-item",{attrs:{index:"/backend/logs"}},[e._v(" Logs")]):e._e(),e._v(" "),r("el-submenu",{attrs:{index:""}},[r("template",{slot:"title"},[e._v(e._s(e.curUser.name))]),e._v(" "),r("el-menu-item",{attrs:{index:"/backend/profile"}},[e._v("\n        profile\n      ")]),e._v(" "),r("el-menu-item",{attrs:{index:""}},[r("i",{on:{click:function(t){e.logout()}}},[e._v("logout\n        ")])])],2)],1)],1)},staticRenderFns:[]};var O=r("Z0/y")(U,z,!1,function(e){r("GzwS")},"data-v-1ac538e0",null).exports,S={name:"go-top",methods:{goTop:function(){document.documentElement.scrollTop=0}}},q={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"pointer-up"},[r("i",{staticClass:"el-icon-caret-top",on:{click:function(t){e.goTop()}}})])},staticRenderFns:[]};var D=r("Z0/y")(S,q,!1,function(e){r("gmNZ")},"data-v-600c861c",null).exports,A=_.bind(null,"/api/v1/category"),E=j.bind(null,"/api/v1/category"),T=j.bind(null,"/api/v1/categories"),N=x.bind(null,"/api/v1/category"),Z=(y.bind(null,"/api/v1/category"),y.bind(null,"/api/v1/categories"));function B(e){return e.inner+2*e.middle+4*e.outer}function V(e){return[!!(1&e),!!(2&e),!!(4&e)]}var M=r("Y0Uy"),H=r.n(M),G={name:"home",components:{"app-header":O,"go-top":D},data:function(){return{categories:[],activeName:[],searchProject:""}},created:function(){this.getCategories()},methods:{getCategories:H.a.debounce(function(){var e=this;return Z({search:this.searchProject}).then(function(t){e.categories=t.categories.map(function(e){return e.Projects=e.Projects.map(function(e){var t=V(e.segment),r=l()(t,3),o=r[0],a=r[1],n=r[2];return e.segment={inner:o,middle:a,outer:n},e}),e}),e.activeName=e.categories.map(function(e){return e.id}),e.$notify({type:"success",title:"success",message:"get categories from server"})}).catch(function(t){e.$notify.error({title:"error",message:t})})},500)},watch:{searchProject:function(){this.getCategories()}}},J={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("app-header"),e._v(" "),r("section",{staticClass:"main"},[r("div",{staticClass:"fluid container"},[r("el-row",{staticClass:"search-project"},[r("el-col",{attrs:{span:6}},[r("el-input",{attrs:{placeholder:"search project",type:"text",clearable:""},model:{value:e.searchProject,callback:function(t){e.searchProject=t},expression:"searchProject"}})],1)],1),e._v(" "),r("el-collapse",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},e._l(e.categories,function(t){return r("el-collapse-item",{key:t.id,attrs:{name:t.id}},[r("template",{slot:"title"},[r("el-tooltip",{attrs:{effect:"dark",content:t.intro,placement:"right-start"}},[r("span",{staticClass:"category-name"},[e._v(e._s(t.name))])])],1),e._v(" "),r("el-row",{staticClass:"project-content",attrs:{gutter:20}},e._l(t.Projects,function(t){return r("el-col",{key:t.id,staticClass:"project-content ",attrs:{span:3}},[r("div",{staticClass:"grid-content"},[r("el-popover",{attrs:{placement:"top-start",title:t.name,width:"400",trigger:"hover"}},[r("el-row",[t.segment.inner?r("el-tag",[e._v("inner")]):e._e(),e._v(" "),t.segment.middle?r("el-tag",{attrs:{type:"warning"}},[e._v("middle")]):e._e(),e._v(" "),t.segment.outer?r("el-tag",{attrs:{type:"success"}},[e._v("outer")]):e._e()],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{staticClass:"project-intro",attrs:{span:12}},[r("p",[e._v(e._s(t.intro))])]),e._v(" "),r("el-col",{staticClass:"project-intro",attrs:{span:8}},[t.logo?r("img",{staticClass:"logo",attrs:{src:t.logo,alt:t.logo}}):e._e()])],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("p",[r("strong",{staticClass:"hint"},[e._v("*hint:")]),e._v(e._s(t.hint))])]),e._v(" "),r("el-col",{attrs:{span:8}},[t.url?r("div",[r("a",{attrs:{href:t.url,target:"_blank"}},[e._v("进入网站")])]):t.QRCode?r("div",[r("el-popover",{attrs:{placement:"right",width:"200",trigger:"click"}},[t.QRCode?r("img",{staticClass:"QRCode",attrs:{src:t.QRCode,alt:t.QRCode}}):e._e(),e._v(" "),r("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v("点击下载")])],1)],1):r("div",[r("p",[e._v("no url and no QR code")])])])],1),e._v(" "),t.logo?r("img",{staticClass:"logo",attrs:{slot:"reference",src:t.logo,alt:t.logo},slot:"reference"}):e._e()],1)],1)])}))],2)}))],1),e._v(" "),r("go-top")],1)],1)},staticRenderFns:[]};var W=r("Z0/y")(G,J,!1,function(e){r("+1+n")},"data-v-71dfd510",null).exports,Y=r("jOEV"),K=r.n(Y),X=r("V45k"),ee=r.n(X),te=(r("xH4k"),{name:"login",components:{dragVerify:K.a},data:function(){return{user:{phone:"",email:"",password:""},rules:{phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[34578]\d{9}$/,message:"目前只支持中国大陆的手机号码"}],email:[{required:!0,message:"请输入邮箱",type:"email"}],password:[{required:!0,message:"请输入密码"},{min:5,max:16,message:"长度在 5 到 16 个字符"}]},error:null,loading:!1,phone:!0,verify:{handlerIcon:"fa fa-angle-double-right",successIcon:"fa fa-check",background:"#cccccc",progressBarBg:"#FFFF99",completedBg:"#66cc66",handlerBg:"#fff",text:"swiping to the right side",successText:"success",width:220,height:40,textSize:"20px",isCircle:!0},captcha:"",code:""}},computed:d()({},Object(a.b)(["isLogin"])),created:function(){this.getCaptcha()},beforeDestroy:function(){this.isLogin||this.captcha&&$({url:this.captcha})},methods:{getShape:function(){return"true"===this.verify.isCircle},getCaptcha:function(){var e=this;P().then(function(t){e.captcha=t.captcha})},submit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.error=null,t.loading=!0;var r={password:ee()(t.user.password,"about oa").toString()};t.phone?(r.phone=t.user.phone,r.email=""):(r.phone="",r.email=t.user.email),r.code=t.code,C(r).then(function(e){t.$store.dispatch("setUserInfo",e.user).then(function(){t.$router.replace({path:t.$route.query.redirect||"/home"}),t.loading=!1})}).catch(function(e){t.error={title:"发生错误",message:e},t.loading=!1})})}}}),re={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"login"},[r("header",{staticClass:"login-header"},[r("h1",{staticClass:"brand"}),e._v(" "),e.error?r("el-alert",{attrs:{title:e.error.title,type:"warning",description:e.error.message,"show-icon":""}}):e._e()],1),e._v(" "),r("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{"auto-complete":"off",model:e.user,"label-width":"75px",rules:e.rules}},[r("h2",{staticClass:"heading"},[e._v("Login")]),e._v(" "),r("el-form-item",[r("el-switch",{attrs:{width:50,"active-text":"phone","inactive-text":"Email"},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1),e._v(" "),e.phone?r("el-form-item",{attrs:{label:"phone",prop:"phone"}},[r("el-input",{attrs:{type:"text",placeholder:"Please enter telephone"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1):r("el-form-item",{attrs:{label:"Email",prop:"email"}},[r("el-input",{attrs:{type:"text",placeholder:"Please enter email"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"password",prop:"password"}},[r("el-input",{attrs:{type:"password",placeholder:"Please enter password"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),e._v(" "),r("el-form-item",[r("el-input",{attrs:{type:"text"},model:{value:e.code,callback:function(t){e.code=t},expression:"code"}}),e._v(" "),r("el-tooltip",{attrs:{effect:"dark",content:"click to change captcha",placement:"right-end"}},[r("img",{staticClass:"captcha",attrs:{src:e.captcha,alt:e.code},on:{click:function(t){e.getCaptcha()}}})])],1),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){e.submit("loginForm")}}},[e._v("\n      "+e._s(e.loading?"Loading...":"Login")+"\n    ")])],1),e._v(" "),r("footer",{staticClass:"login-footer"},[e._v("\n    Not a member go to\n    "),r("router-link",{attrs:{to:"/reg"}},[e._v("register")])],1)],1)},staticRenderFns:[]};var oe=r("Z0/y")(te,re,!1,function(e){r("W4kt")},null,null).exports,ae={name:"reg",components:{dragVerify:K.a},data:function(){var e=this;return{user:{phone:"",email:"",name:"",password:"",passwordR:""},rules:{name:[{required:!0,message:"请输入用户名"},{min:5,max:16,message:"长度在 5 到 16 个字符"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[34578]\d{9}$/,message:"目前只支持中国大陆的手机号码"}],email:[{required:!0,message:"请输入邮箱",type:"email"}],password:[{required:!0,message:"请输入密码"},{min:5,max:16,message:"长度在 5 到 16 个字符"}],passwordR:[{validator:function(t,r,o){""===r?o(new Error("请再次输入密码")):r!==e.user.password?o(new Error("两次输入密码不一致!")):o()},trigger:"blur"},{required:!0,message:"请再次输入密码",trigger:"blur"}]},error:null,loading:!1,phone:!0,verify:{handlerIcon:"fa fa-angle-double-right",successIcon:"fa fa-check",background:"#cccccc",progressBarBg:"#FFFF99",completedBg:"#66cc66",handlerBg:"#fff",text:"swiping to the right side",successText:"success",width:220,height:40,textSize:"20px",isCircle:!0}}},methods:{getShape:function(){return"true"===this.verify.isCircle},submit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.error=null,t.loading=!0;var r=ee()(t.user.password,"about oa").toString();w({name:t.user.name,phone:t.user.phone,email:t.user.email,password:r}).then(function(e){t.$store.dispatch("setUserInfo",e.user).then(function(){t.$router.replace({path:t.$route.query.redirect||"/home"}),t.loading=!1})}).catch(function(e){t.error={title:"发生错误",message:e},t.loading=!1})})}}},ne={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"login"},[r("header",{staticClass:"login-header"},[e.error?r("el-alert",{attrs:{title:e.error.title,type:"warning",description:e.error.message,"show-icon":""}}):e._e()],1),e._v(" "),r("el-form",{ref:"loginForm",staticClass:"login-form",attrs:{"auto-complete":"off",model:e.user,"label-width":"75px",rules:e.rules}},[r("h2",{staticClass:"heading"},[e._v("Register")]),e._v(" "),r("el-form-item",[r("el-switch",{attrs:{width:50,"active-text":"phone","inactive-text":"Email"},model:{value:e.phone,callback:function(t){e.phone=t},expression:"phone"}})],1),e._v(" "),e.phone?r("el-form-item",{attrs:{label:"phone",prop:"phone"}},[r("el-input",{attrs:{type:"text",placeholder:"Please enter telephone"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1):r("el-form-item",{attrs:{label:"Email",prop:"email"}},[r("el-input",{attrs:{type:"text",placeholder:"Please enter email"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"name",prop:"name"}},[r("el-input",{attrs:{type:"text",placeholder:"Please enter username"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"password",prop:"password"}},[r("el-input",{attrs:{type:"password",placeholder:"Please enter password"},model:{value:e.user.password,callback:function(t){e.$set(e.user,"password",t)},expression:"user.password"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"password",prop:"passwordR"}},[r("el-input",{attrs:{type:"password",placeholder:"Please enter password"},model:{value:e.user.passwordR,callback:function(t){e.$set(e.user,"passwordR",t)},expression:"user.passwordR"}})],1),e._v(" "),r("el-form-item",[r("drag-verify",{attrs:{width:e.verify.width,height:e.verify.height,text:e.verify.text,"success-text":e.verify.successText,background:e.verify.background,"progress-bar-bg":e.verify.progressBarBg,"completed-bg":e.verify.completedBg,"handler-bg":e.verify.handlerBg,"handler-icon":e.verify.handlerIcon,"text-size":e.verify.textSize,"success-icon":e.verify.successIcon,circle:e.verify.isCircle}})],1),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){e.submit("loginForm")}}},[e._v("\n      "+e._s(e.loading?"Loading...":"Register")+"\n    ")])],1),e._v(" "),r("footer",{staticClass:"login-footer"},[e._v("\n    already register go to\n    "),r("router-link",{attrs:{to:"/login"}},[e._v("login")])],1)],1)},staticRenderFns:[]};var se=r("Z0/y")(ae,ne,!1,function(e){r("a+yd")},null,null).exports,ie={name:"backend",components:{"app-header":O},methods:{}},ce={render:function(){var e=this.$createElement,t=this._self._c||e;return t("div",[t("app-header"),this._v(" "),t("section",{staticClass:"main"},[t("router-view",{staticClass:"inner"})],1)],1)},staticRenderFns:[]};var le=r("Z0/y")(ie,ce,!1,function(e){r("dJdu")},"data-v-4d806047",null).exports,ue={name:"users",data:function(){return{users:[],total:100,search:"",pageIndex:1,pageSize:10}},created:function(){this.getUsers()},watch:{search:function(){this.getUsers()}},methods:{getUsers:Object(M.debounce)(function(){var e=this;return F({pageIndex:this.pageIndex,pageSize:this.pageSize,search:this.search}).then(function(t){e.users=t.users.rows,e.total=t.users.count}).catch(function(t){e.$notify.error({title:"error",message:t})})},500),handleGrantUser:function(e,t,r){var o=this;Q({id:t.id,permission:r}).then(function(){o.$notify({type:"success",title:"grantUser",message:t.id+":"+t.name+" permission: "+t.permission+"->"+r}),t.permission=r}).catch(function(e){o.$notify({type:"error",title:"grantUser",message:e})})},handleDelUser:function(e,t){var r=this;this.$confirm("此操作将永久删除该用户, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){R({id:t.id}).then(function(){r.users.splice(e,1),r.$message({type:"success",message:"删除成功!"+t.name})})}).catch(function(){r.$message({type:"info",message:"已取消删除"})})},handleCurrentChange:function(e){this.pageIndex=e,this.getUsers()},handleSizeChange:function(e){this.pageSize=e,this.getUsers()}}},de={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("h1",[e._v("users")]),e._v(" "),r("div",{staticClass:"search"},[r("el-col",{attrs:{span:5}},[r("el-input",{attrs:{placeholder:"搜索用户",size:"medium",clearable:""},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1)],1),e._v(" "),r("div",{staticClass:"table"},[r("el-table",{attrs:{data:e.users,border:"",size:"medium"}},[r("el-table-column",{attrs:{prop:"name",label:"姓名",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"email",label:"邮箱",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"phone",label:"电话",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{prop:"intro",label:"简介",align:"center"}}),e._v(" "),r("el-table-column",{attrs:{label:"操作",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[90===t.row.permission?r("el-button",{attrs:{size:"mini",type:"info"},on:{click:function(r){e.handleGrantUser(t.$index,t.row,0)}}},[e._v("grant user\n          ")]):0===t.row.permission?r("el-button",{attrs:{size:"mini",type:"success"},on:{click:function(r){e.handleGrantUser(t.$index,t.row,90)}}},[e._v("grant amdin\n          ")]):e._e(),e._v(" "),r("el-button",{attrs:{size:"mini",type:"danger"},on:{click:function(r){e.handleDelUser(t.$index,t.row)}}},[e._v("删除\n          ")])]}}])})],1)],1),e._v(" "),r("div",{staticClass:"block"},[r("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":[5,10,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)])},staticRenderFns:[]};var pe=r("Z0/y")(ue,de,!1,function(e){r("kp9x")},"data-v-10a5a18a",null).exports,ge=y.bind(null,"/api/v1/logs"),me={name:"logs",data:function(){return{pickerOptions:{disabledDate:function(e){return e.getTime()>Date.now()},shortcuts:[{text:"最近一周",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-6048e5),e.$emit("pick",[r,t])}},{text:"最近一个月",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-2592e6),e.$emit("pick",[r,t])}},{text:"最近三个月",onClick:function(e){var t=new Date,r=new Date;r.setTime(r.getTime()-7776e6),e.$emit("pick",[r,t])}}]},timeZone:"",logs:[],total:100,search:"",pageIndex:1,pageSize:10}},created:function(){this.getLogs()},filters:{timestampsFilter:function(e){return e?new Date(e).toLocaleDateString():""}},watch:{search:function(){this.getLogs()}},methods:{getLogs:Object(M.debounce)(function(){var e=this,t=this.timeZone[0]||"",r=this.timeZone[1]||"";return console.log(t),console.log(r),ge({pageIndex:this.pageIndex,pageSize:this.pageSize,search:this.search,start:t,end:r}).then(function(t){e.logs=t.logs.rows,e.total=t.logs.count}).catch(function(t){e.$notify.error({title:"error",message:t})})},500),handleDatePicker:function(){this.getLogs()},handleCurrentChange:function(e){this.pageIndex=e,this.getLogs()},handleSizeChange:function(e){this.pageSize=e,this.getLogs()},formatTime:function(e,t,r,o){return r?new Date(r).toLocaleString():""}}},he={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",[r("el-row",{staticClass:"datePicker",attrs:{gutter:20}},[r("el-col",{staticClass:"search",attrs:{span:5}},[r("el-input",{attrs:{type:"text",clearable:!0,placeholder:"search logs"},model:{value:e.search,callback:function(t){e.search=t},expression:"search"}})],1),e._v(" "),r("el-col",{attrs:{span:10}},[r("el-date-picker",{attrs:{type:"daterange",align:"center","value-format":"yyyy-MM-dd","unlink-panels":"","range-separator":"至","start-placeholder":"开始日期","end-placeholder":"结束日期","picker-options":e.pickerOptions},on:{change:e.handleDatePicker},model:{value:e.timeZone,callback:function(t){e.timeZone=t},expression:"timeZone"}})],1)],1),e._v(" "),r("el-row",{attrs:{gutter:18}},[r("el-table",{staticClass:"logs-table",attrs:{data:e.logs,size:"medium",border:"",stripe:""}},[r("el-table-column",{attrs:{prop:"content","header-align":"center",align:"left",label:"content"}}),e._v(" "),r("el-table-column",{attrs:{prop:"createTime","header-align":"center",align:"left",label:"time",sortable:!0,"sort-by":"createTime",formatter:e.formatTime,width:"180"}})],1)],1),e._v(" "),r("el-row",{staticClass:"page"},[r("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":[10,20],"page-size":e.pageSize,layout:"total, sizes, prev, pager, next, jumper",total:e.total},on:{"size-change":e.handleSizeChange,"current-change":e.handleCurrentChange}})],1)],1)},staticRenderFns:[]};var fe=r("Z0/y")(me,he,!1,function(e){r("ri7w")},"data-v-19200df8",null).exports,ve={name:"profile",data:function(){return{user:{id:0,name:"",permission:0,intro:"",phone:"",email:""},rules:{name:[{required:!0,message:"请输入用户名"},{min:5,max:16,message:"长度在 5 到 16 个字符"}],phone:[{required:!0,message:"",trigger:"blur"},{pattern:/^1[34578]\d{9}$/,message:"目前只支持中国大陆的手机号码"}],email:[{required:!0,message:"",type:"email"}],intro:[{required:!1,message:""},{min:20,max:120,message:"长度在 20 到 120 个字符"}]},error:null,loading:!1}},created:function(){this.user=this.$store.getters.getUserInfo},methods:{submit:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;t.error=null,t.loading=!0,I(t.user).then(function(e){t.$store.dispatch("setUserInfo",t.user).then(function(){t.loading=!1,t.$notify({title:"success",message:"updated",type:"success"})})}).catch(function(e){t.error={title:"发生错误",message:e},t.loading=!1})})},getUser:function(){var e=this;L({id:this.user.id}).then(function(t){e.user=t.user,e.$store.dispatch("setUserInfo",t.user)}).catch(function(t){e.$notify.error({title:"error",message:t})})}}},be={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("section",{staticClass:"userWrap"},[r("header",[e.error?r("el-alert",{attrs:{title:e.error.title,type:"warning",description:e.error.message,"show-icon":""}}):e._e()],1),e._v(" "),r("el-form",{ref:"loginForm",attrs:{"auto-complete":"on",model:e.user,"label-width":"75px",size:"mini",rules:e.rules}},[r("h2",[e._v("Setting")]),e._v(" "),r("el-form-item",{attrs:{label:"name",prop:"name"}},[r("el-input",{attrs:{type:"text",placeholder:"Please enter username"},model:{value:e.user.name,callback:function(t){e.$set(e.user,"name",t)},expression:"user.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"phone",prop:"phone"}},[r("el-input",{attrs:{type:"text",placeholder:"Please enter telephone"},model:{value:e.user.phone,callback:function(t){e.$set(e.user,"phone",t)},expression:"user.phone"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"Email",prop:"email"}},[r("el-input",{attrs:{type:"text",placeholder:"Please enter email"},model:{value:e.user.email,callback:function(t){e.$set(e.user,"email",t)},expression:"user.email"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"intro",prop:"intro"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4},placeholder:"Please enter introduction"},model:{value:e.user.intro,callback:function(t){e.$set(e.user,"intro",t)},expression:"user.intro"}})],1),e._v(" "),r("el-button",{attrs:{type:"primary",loading:e.loading},on:{click:function(t){e.submit("loginForm")}}},[e._v("\n      "+e._s(e.loading?"Loading...":"Update")+"\n    ")])],1)],1)},staticRenderFns:[]};var ye=r("Z0/y")(ve,be,!1,function(e){r("W+bB")},"data-v-166bf206",null).exports,_e=r("405r"),je=r.n(_e),xe=_.bind(null,"/api/v1/project"),Ce=j.bind(null,"/api/v1/project"),we=j.bind(null,"/api/v1/projects"),ke=x.bind(null,"/api/v1/project"),Pe=(y.bind(null,"/api/v1/project"),y.bind(null,"/api/v1/projects"),x.bind(null,"/api/v1/projectimage")),$e={name:"categories",components:{draggable:je.a,"go-top":D},data:function(){var e=this;return{category:{name:"",intro:""},searchProject:"",project:{changeOrder:0,changeLogo:0,changeQRCode:0,id:0,name:"",intro:"",logo:"",segment:{inner:0,middle:0,outer:0},url:"",QRCode:"",hint:"",categoryId:0},urlType:!1,rules:{name:[{required:!0,message:"请输入类别名称"},{min:5,max:30,message:"长度在 5 到 30 个字符"}],intro:[{required:!0,message:"请输入类别描述"},{min:10,max:120,message:"长度在 10 到 120 个字符"}]},projectRules:{name:[{required:!0,message:"请输入项目名称"},{min:5,max:30,message:"长度在 5 到 30 个字符"}],intro:[{required:!0,message:"请输入项目描述"},{min:10,max:120,message:"长度在 10 到 120 个字符"}],url:[{required:!1,type:"url"},{validator:function(t,r,o){""===r&&""===e.project.QRCode&&o(new Error("url and QR code should not be empty at the same time!")),o()},trigger:"blur"}],QRCode:[{required:!1},{validator:function(t,r,o){""===r&&""===e.project.url&&o(new Error("url and QR code should not be empty at the same time!")),o()},trigger:"blur"}],hint:[{required:!0,message:"请输入项目hint"},{min:10,max:100,message:"长度在 10 到 100 个字符"}]},categories:[],activeName:[],editable:!0,draggable:!0,isDragging:!1,projectFormVisible:!1,delayedDragging:!1}},created:function(){this.getCategories()},methods:{setCateFormName:function(e){return"category"+e},setProFormName:function(e){return"project"+e},handleDialogClose:function(e){this.cancelProForm(1,1),e()},isQRCode:function(){return this.urlType},cancelProForm:function(e,t){this.projectFormVisible=!1;var r=this.project.logo,o=this.project.QRCode;e&&r&&this.project.changeLogo&&this.removeImage(r),t&&o&&this.project.changeQRCode&&this.removeImage(o),this.project={changeOrder:0,changeLogo:0,changeQRCode:0,id:0,name:"",intro:"",logo:"",segment:{inner:0,middle:0,outer:0},url:"",QRCode:"",hint:"",categoryId:0}},addProForm:function(e){this.project.categoryId=e,this.projectFormVisible=!0,this.$notify({type:"info",title:"add project form",message:this.project})},editProForm:function(e){this.project=H.a.cloneDeep(e),this.urlType=this.project.QRCode?1:0,this.projectFormVisible=!0,this.$notify({type:"success",title:"add project form",message:this.project})},submitProForm:function(e){var t=this;this.$refs[e].validate(function(e){if(!e)return!1;if(0===t.project.id){var r=H.a.omit(t.project,["id","changeOrder","changeLogo","changeQRCode","order"]);r.segment=B(r.segment);var o=V(r.segment),a=l()(o,3),n=a[0],s=a[1],i=a[2],c=0;t.urlType?r.url="":(r.QRCode="",c=1),console.log(h()(r)),xe(r).then(function(e){t.cancelProForm(0,c),t.getCategories(),t.$notify({type:"success",title:"create project",message:"segment:"+r.segment+":"+n+"-"+s+"-"+i})}).catch(function(e){t.$notify({type:"error",title:"create project",message:e})})}else{var u=H.a.omit(t.project,["changeOrder","order","categoryId","changeLogo","changeQRCode"]);u.segment=B(u.segment);var d=0;t.urlType?u.url="":(u.QRCode="",d=1),console.log("in form update project"+h()(u)),console.log("removeQRCode:"+d),Ce({project:h()(u)}).then(function(e){t.cancelProForm(0,d),t.getCategories()}).catch(function(e){t.$notify.error({title:"update project",message:e})})}})},deleteProject:function(e,t){var r=this;this.$confirm("此操作将永久删除该项目, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){ke({id:e}).then(function(o){var a=r.categories.findIndex(function(e){return e.id===t}),n=r.categories[a].Projects.findIndex(function(t){return t.id===e});console.log("del project cateIndex-proIndex:"+a+"-"+n);for(var s=n+1;s<r.categories[a].Projects.length;s++)r.categories[a].Projects[s].order-=1,r.categories[a].Projects[s].changeOrder=1;n===r.categories[a].Projects.length-1?r.categories[a].Projects.pop():0===n?r.categories[a].Projects.shift():r.categories[a].Projects.splice(n,1),r.updateProjectOrder(),r.$notify({type:"success",title:"delete",message:"project delete id-:cateIndex-proIndex:"+e+"-"+a+"-"+n})}).catch(function(t){r.$notify({type:"error",title:"delete",message:"category delete"+e})})}).catch(function(){r.$message({type:"info",message:"已取消删除"})})},deleteCategory:function(e){var t=this,r=this.categories.findIndex(function(t){return t.id===e}),o="此操作将永久删除该类别及对应的"+this.categories[r].Projects.length+"个项目, 是否继续?";this.$confirm(o,"提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning",center:!0}).then(function(){N({id:e}).then(function(r){var o=t.categories.findIndex(function(t){return t.id===e});console.log("start:"+o);for(var a=o+1;a<t.categories.length;a++)t.categories[a].order-=1,t.categories[a].changed=1;o===t.categories.length-1?t.categories.pop():0===o?t.categories.shift():t.categories.splice(o,1),t.updateCategoryOrder(),t.$notify({type:"success",title:"delete",message:"category delete id"+e+"-start:"+o})}).catch(function(r){t.$notify({type:"error",title:"delete",message:"category delete"+e})})}).catch(function(){t.$message({type:"info",message:"已取消删除"})})},getCategories:H.a.debounce(function(){var e=this;return Z({search:this.searchProject}).then(function(t){e.categories=t.categories.map(function(e){return e.changed=0,e.Projects=e.Projects.map(function(e){var t=V(e.segment),r=l()(t,3),o=r[0],a=r[1],n=r[2];return e.changeOrder=0,e.changeLogo=0,e.changeQRCode=0,e.segment={inner:o,middle:a,outer:n},e}),e}),e.$notify({type:"success",title:"success",message:"get categories from server"})}).catch(function(t){e.$notify.error({title:"error",message:t})})},500),updateCategoryOrder:function(){for(var e=this,t=[],r=0;r<this.categories.length;r++){var o=this.categories[r];o.changed&&t.push({id:o.id,order:o.order})}T({categories:h()(t)}).then(function(t){for(var r=0;r<e.categories.length;r++)e.categories[r].changed=0;e.$notify({type:"success",title:"success",message:"category order update"})}).catch(function(t){e.$notify.error({title:"error",message:t})})},updateProjectOrder:function(e){for(var t=this,r=[],o=0;o<this.categories.length;o++)for(var a=this.categories[o],n=a.Projects,s=0;s<n.length;s++){var i=n[s];i.changeOrder&&r.push({id:i.id,order:i.order,categoryId:a.id})}we({projects:h()(r)}).then(function(r){if(e)for(var o=0;o<t.categories.length;o++)for(var a=0;a<t.categories[o].Projects.length;a++)t.categories[o].Projects[a].changeOrder=0,t.categories[o].Projects[a].categoryId=t.categories[o].id;else for(var n=0;n<t.categories.length;n++)for(var s=0;s<t.categories[n].Projects.length;s++)t.categories[n].Projects[s].changeOrder=0;t.$notify({type:"success",title:"success",message:"project order update"})}).catch(function(e){t.$notify.error({title:"error",message:e})})},updateCategory:function(e,t){var r=this;this.$refs[e][0].validate(function(e){if(!e)return!1;var o=r.categories.findIndex(function(e){return e.id===t}),a=H.a.omit(r.categories[o],["changed","order","Projects"]);console.log("in form update category"+h()(a)),E({category:h()(a)}).then(function(e){r.$notify({type:"success",title:"success",message:"category update"+a})}).catch(function(e){r.$notify.error({title:"error",message:e})})})},submit:function(e){var t=this;this.$refs[e].validate(function(r){if(!r)return!1;A(t.category).then(function(r){t.$refs[e].resetFields(),t.getCategories(),t.$notify({type:"success",title:"success",message:"category create"})}).catch(function(e){t.$notify.error({title:"error",message:e})})})},startDrag:function(){this.isDragging=!0},endDrag:function(){this.isDragging=!1},handleCateChange:function(e){if(e.moved){var t=e.moved.newIndex,r=e.moved.oldIndex;e.moved.element;if(this.categories[t].order+=t-r,this.categories[t].changed=1,t>r)for(var o=r;o<t;o++)this.categories[o].order-=1,this.categories[o].changed=1;else for(var a=t+1;a<=r;a++)this.categories[a].order+=1,this.categories[a].changed=1;this.updateCategoryOrder()}},handleProChange:function(e){if(e.moved){var t=e.moved.newIndex,r=e.moved.oldIndex,o=e.moved.element,a=this.categories.findIndex(function(e){return e.id===o.categoryId});if(this.categories[a].Projects[t].order+=t-r,this.categories[a].Projects[t].changeOrder=1,t>r)for(var n=r;n<t;n++)this.categories[a].Projects[n].order-=1,this.categories[a].Projects[n].changeOrder=1;else for(var s=t+1;s<=r;s++)this.categories[a].Projects[s].order+=1,this.categories[a].Projects[s].changeOrder=1;this.updateProjectOrder()}else if(e.added){var i=e.added.newIndex,c=e.added.element,l=this.categories.findIndex(function(e){return!!e.Projects[i]&&e.Projects[i].id===c.id});if(i===this.categories[l].Projects.length-1)1===this.categories[l].Projects.length?(this.categories[l].Projects[i].order=1,this.categories[l].Projects[i].changeOrder=1):(this.categories[l].Projects[i].order=this.categories[l].Projects[i-1].order+1,this.categories[l].Projects[i].changeOrder=1);else{1===this.categories[l].Projects.length?(this.categories[l].Projects[i].order=1,this.categories[l].Projects[i].changeOrder=1):(this.categories[l].Projects[i].order=this.categories[l].Projects[i+1].order,this.categories[l].Projects[i].changeOrder=1);for(var u=i+1;u<this.categories[l].Projects.length;u++)this.categories[l].Projects[u].order+=1,this.categories[l].Projects[u].changeOrder=1}console.log("added Index:"+l)}else if(e.removed){for(var d=e.removed.oldIndex,p=e.removed.element,g=this.categories.findIndex(function(e){return e.id===p.categoryId}),m=d;m<this.categories[g].Projects.length;m++)this.categories[g].Projects[m].order-=1,this.categories[g].Projects[m].changeOrder=1;console.log("removed Index:"+g),this.updateProjectOrder(1)}},handleProAdd:function(e){},handleProRemove:function(e){},handleProUpdate:function(e){},onMove:function(e){var t=e.relatedContext,r=e.draggedContext;t.element,r.element;return!0},setUploadData:function(e){return{type:e}},handleLogoError:function(e,t,r){console.log("logo error"),console.log(e)},uploadLogo:function(e,t,r){console.log("after uploadLogo success"),console.log(h()(t),h()(r));var o=this.project.logo;o&&this.project.changeLogo&&this.removeImage(o),this.project.logo=e.url,this.project.changeLogo=1,this.$notify({type:"success",title:"logo response",message:e})},uploadQRCode:function(e,t,r){console.log("after upload QR code success");var o=this.project.QRCode;o&&this.project.changeQRCode&&this.removeImage(o),this.project.QRCode=e.url,this.project.changeQRCode=1,this.$notify({type:"success",title:"QRCode response",message:e})},beforeLogoUpload:function(e){var t="image/jpeg"===e.type||"image/png"===e.type||"image/gif"===e.type,r=e.size/1024/1024<2;return t||this.$message.error("上传头像图片只能是 JPG, PNG, GIF 格式!"),r||this.$message.error("上传头像图片大小不能超过 2MB!"),t&&r},removeImage:function(e){var t=this;Pe({image:e}).then(function(e){t.$notify({type:"success",title:"remove image"})}).catch(function(e){t.$notify({type:"error",title:"remove image",message:e})})}},computed:{categoryOptions:function(){return{group:"category",disabled:!this.draggable,ghostClass:"ghost"}},projectOptions:function(){return{group:"project",disabled:!this.draggable,ghostClass:"ghost"}}},watch:{isDragging:function(e){var t=this;e?this.delayedDragging=!0:this.$nextTick(function(){t.delayedDragging=!1})},searchProject:function(){this.getCategories()}}},Ie={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"margin-self"},[r("h1",[e._v("categories")]),e._v(" "),r("div",{staticClass:"cateWrap"},[r("el-form",{ref:"cateForm",staticClass:"category-form",attrs:{"auto-complete":"on",model:e.category,"label-width":"60px",size:"medium",inline:!0,rules:e.rules}},[r("el-form-item",{attrs:{label:"name",prop:"name"}},[r("el-input",{staticStyle:{width:"10em"},attrs:{type:"text",placeholder:"Please enter name"},model:{value:e.category.name,callback:function(t){e.$set(e.category,"name",t)},expression:"category.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"intro",prop:"intro"}},[r("el-input",{attrs:{type:"text",placeholder:"Please enter intro"},model:{value:e.category.intro,callback:function(t){e.$set(e.category,"intro",t)},expression:"category.intro"}})],1),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submit("cateForm")}}},[e._v("\n        new category\n      ")])],1)],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{staticClass:"searchProject",attrs:{span:6}},[r("el-input",{attrs:{placeholder:"search project",type:"text",clearable:""},model:{value:e.searchProject,callback:function(t){e.searchProject=t},expression:"searchProject"}})],1),e._v(" "),r("el-col",{staticClass:"checkbox",attrs:{span:7}},[r("el-checkbox",{model:{value:e.editable,callback:function(t){e.editable=t},expression:"editable"}},[e._v("Enable edit categories")])],1),e._v(" "),r("el-col",{staticClass:"checkbox",attrs:{span:7}},[r("el-checkbox",{model:{value:e.draggable,callback:function(t){e.draggable=t},expression:"draggable"}},[e._v("Enable drag and drop")])],1)],1),e._v(" "),r("div",{staticClass:"fluid container"},[r("el-row",{attrs:{gutter:22}},[r("draggable",{staticClass:"category-group",attrs:{element:"div",options:e.categoryOptions,move:e.onMove},on:{start:e.startDrag,end:e.endDrag,change:e.handleCateChange},model:{value:e.categories,callback:function(t){e.categories=t},expression:"categories"}},[r("transition-group",{staticClass:"list-group",attrs:{type:"transition"}},e._l(e.categories,function(t){return r("el-row",{key:t.id,staticClass:"category"},[r("el-collapse",{staticClass:"collapse-self"},[r("el-collapse-item-about",{attrs:{name:t.id}},[r("template",{slot:"title"},[r("el-form",{ref:e.setCateFormName(t.id),refInFor:!0,staticClass:"category-form",attrs:{"auto-complete":"on",model:t,"label-width":"60px",size:"medium",disabled:!e.editable,inline:!0,rules:e.rules}},[r("el-form-item",{attrs:{prop:"name"}},[r("el-input",{staticStyle:{width:"10em"},attrs:{type:"text",placeholder:"Please enter name"},model:{value:t.name,callback:function(r){e.$set(t,"name",r)},expression:"category.name"}})],1),e._v(" "),r("el-form-item",{attrs:{prop:"intro"}},[r("el-input",{attrs:{type:"text",placeholder:"Please enter intro"},model:{value:t.intro,callback:function(r){e.$set(t,"intro",r)},expression:"category.intro"}})],1),e._v(" "),r("el-form-item",[r("el-button",{staticClass:"icon-size-36",attrs:{type:"primary",icon:"el-icon-success",circle:""},on:{click:function(r){e.updateCategory(e.setCateFormName(t.id),t.id)}}})],1),e._v(" "),r("el-form-item",[r("el-button",{staticClass:"icon-size-36",attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(r){e.deleteCategory(t.id)}}})],1)],1)],1),e._v(" "),r("el-row",{staticClass:"project-content",attrs:{gutter:20}},[r("draggable",{staticClass:"list-group",attrs:{element:"div",options:e.projectOptions,move:e.onMove},on:{change:e.handleProChange,start:e.startDrag,end:e.endDrag,add:e.handleProAdd,remove:e.handleProRemove,update:e.handleProUpdate},model:{value:t.Projects,callback:function(r){e.$set(t,"Projects",r)},expression:"category.Projects"}},[r("transition-group",{staticClass:"project-group",attrs:{type:"transition"}},e._l(t.Projects,function(t){return r("el-col",{key:t.id,staticClass:"project-content ",attrs:{span:3}},[r("div",{staticClass:"grid-content"},[r("el-popover",{attrs:{placement:"top-start",title:t.name,width:"400",trigger:"hover"}},[r("el-row",[t.segment.inner?r("el-tag",[e._v("inner")]):e._e(),e._v(" "),t.segment.middle?r("el-tag",{attrs:{type:"warning"}},[e._v("middle")]):e._e(),e._v(" "),t.segment.outer?r("el-tag",{attrs:{type:"success"}},[e._v("outer")]):e._e()],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{staticClass:"project-intro",attrs:{span:12}},[r("p",[e._v(e._s(t.intro))])]),e._v(" "),r("el-col",{staticClass:"project-intro",attrs:{span:8}},[t.logo?r("img",{staticClass:"logo",attrs:{src:t.logo,alt:t.logo}}):e._e()])],1),e._v(" "),r("el-row",{attrs:{gutter:20}},[r("el-col",{attrs:{span:12}},[r("p",[r("strong",{staticClass:"hint"},[e._v("*hint:")]),e._v(e._s(t.hint))])]),e._v(" "),r("el-col",{attrs:{span:8}},[t.url?r("div",[r("a",{attrs:{href:t.url,target:"_blank"}},[e._v("进入网站")])]):t.QRCode?r("div",[r("el-popover",{attrs:{placement:"right",width:"200",trigger:"click"}},[t.QRCode?r("img",{staticClass:"QRCode",attrs:{src:t.QRCode,alt:t.QRCode}}):e._e(),e._v(" "),r("el-button",{attrs:{slot:"reference"},slot:"reference"},[e._v("点击下载")])],1)],1):r("div",[r("p",[e._v("no url and no QR code")])])])],1),e._v(" "),r("el-row",[r("el-button",{attrs:{type:"success",icon:"el-icon-edit-outline"},on:{click:function(r){e.editProForm(t)}}}),e._v(" "),r("el-button",{attrs:{type:"danger",icon:"el-icon-delete"},on:{click:function(r){e.deleteProject(t.id,t.categoryId)}}})],1),e._v(" "),t.logo?r("img",{staticClass:"logo",attrs:{slot:"reference",src:t.logo,alt:t.logo},slot:"reference"}):e._e()],1)],1)])}))],1),e._v(" "),r("el-col",{attrs:{span:6}},[r("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"new project",placement:"right"}},[r("el-button",{attrs:{type:"success",icon:"el-icon-plus",circle:""},on:{click:function(r){e.addProForm(t.id)}}})],1)],1)],1)],2)],1)],1)}))],1)],1),e._v(" "),r("go-top")],1),e._v(" "),r("div",[r("el-dialog",{attrs:{title:"new project",visible:e.projectFormVisible,"before-close":e.handleDialogClose},on:{"update:visible":function(t){e.projectFormVisible=t}}},[r("div",[r("el-form",{ref:e.setProFormName(e.project.id),attrs:{model:e.project,"label-width":"70px","auto-complete":"on",rules:e.projectRules}},[r("el-form-item",{attrs:{label:"name",prop:"name"}},[r("el-input",{attrs:{type:"text"},model:{value:e.project.name,callback:function(t){e.$set(e.project,"name",t)},expression:"project.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"hint",prop:"hint"}},[r("el-input",{attrs:{type:"text"},model:{value:e.project.hint,callback:function(t){e.$set(e.project,"hint",t)},expression:"project.hint"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"intro",prop:"intro"}},[r("el-input",{attrs:{type:"textarea",autosize:{minRows:2,maxRows:4}},model:{value:e.project.intro,callback:function(t){e.$set(e.project,"intro",t)},expression:"project.intro"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"logo",prop:"logo"}},[r("el-upload",{ref:"uploadLogo",staticClass:"avatar-uploader",attrs:{multiple:!1,"show-file-list":!1,data:e.setUploadData(0),action:"/api/v1/projectimage","before-upload":e.beforeLogoUpload,"on-error":e.handleLogoError,"on-success":e.uploadLogo}},[e.project.logo?r("img",{staticClass:"avatar",attrs:{src:e.project.logo,alt:e.project.logo}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1),e._v(" "),r("el-form-item",[r("el-switch",{attrs:{"active-text":"QR code","inactive-text":"web url"},model:{value:e.urlType,callback:function(t){e.urlType=t},expression:"urlType"}})],1),e._v(" "),e.isQRCode()?r("el-form-item",{attrs:{label:"code",prop:"QRCode"}},[r("el-upload",{ref:"uploadQRCode",staticClass:"avatar-uploader",attrs:{multiple:!1,"show-file-list":!1,data:e.setUploadData(1),action:"/api/v1/projectimage","before-upload":e.beforeLogoUpload,"on-error":e.handleLogoError,"on-success":e.uploadQRCode}},[e.project.QRCode?r("img",{staticClass:"avatar",attrs:{src:e.project.QRCode,alt:e.project.QRCode}}):r("i",{staticClass:"el-icon-plus avatar-uploader-icon"})])],1):r("el-form-item",{attrs:{label:"url",prop:"url"}},[r("el-input",{attrs:{type:"text",placeholder:"web url"},model:{value:e.project.url,callback:function(t){e.$set(e.project,"url",t)},expression:"project.url"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"segment",prop:"segment"}},[r("el-checkbox",{model:{value:e.project.segment.inner,callback:function(t){e.$set(e.project.segment,"inner",t)},expression:"project.segment.inner"}},[e._v("inner")]),e._v(" "),r("el-checkbox",{model:{value:e.project.segment.middle,callback:function(t){e.$set(e.project.segment,"middle",t)},expression:"project.segment.middle"}},[e._v("middle")]),e._v(" "),r("el-checkbox",{model:{value:e.project.segment.outer,callback:function(t){e.$set(e.project.segment,"outer",t)},expression:"project.segment.outer"}},[e._v("outer")])],1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.cancelProForm(1,1)}}},[e._v("取 消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){e.submitProForm(e.setProFormName(e.project.id))}}},[e._v("确 定")])],1)])],1)],1)},staticRenderFns:[]};var Re=r("Z0/y")($e,Ie,!1,function(e){r("87Jk")},"data-v-11e6dea8",null).exports;o.default.use(i.a);var Fe=[{path:"/",name:"",component:W,meta:{requiresAuth:!0}},{path:"/reg",name:"reg",component:se,meta:{requiresNotAuth:!0}},{path:"/login",name:"login",component:oe,meta:{requiresNotAuth:!0}},{path:"/home",name:"home",component:W,meta:{requiresAuth:!0}},{path:"/backend",name:"backend",component:le,meta:{requiresAuth:!0},children:[{path:"profile",name:"profile",component:ye,meta:{requiresAuth:!0}},{path:"",name:"main",component:Re,meta:{requiresAdmin:!0}},{path:"users",name:"users",component:pe,meta:{requiresAdmin:!0}},{path:"logs",name:"logs",component:fe,meta:{requiresAdmin:!0}},{path:"categories",name:"categories",component:Re,meta:{requiresAdmin:!0}}]}],Le=new i.a({mode:"history",routes:Fe});Le.beforeEach(function(e,t,r){e.matched.some(function(e){return e.meta.requiresAuth})?e.matched.some(function(e){return e.meta.requiresAdmin})?f.getters.isAdmin?r():r({path:"/home"}):f.getters.isLogin?r():r({path:"/login",query:{redirect:e.fullPath}}):e.matched.some(function(e){return e.meta.requiresNotAuth})&&f.getters.isLogin?r({path:"/home"}):r()});var Qe=Le,Ue=r("x4un"),ze=r.n(Ue),Oe=r("bY4P"),Se=(r("4qN4"),r("cpDg"),r("pZVs"),r("AYur")),qe=r("VHII"),De=r("PrVi"),Ae={name:"ElCollapseItemAbout",componentName:"ElCollapseItemAbout",mixins:[qe.a],components:{ElCollapseTransition:Se.a},data:function(){return{contentWrapStyle:{height:"auto",display:"block"},contentHeight:0,focusing:!1,isClick:!1}},inject:["collapse"],props:{title:String,name:{type:[String,Number],default:function(){return this._uid}}},computed:{isActive:function(){return this.collapse.activeNames.indexOf(this.name)>-1},id:function(){return Object(De.a)()}},methods:{handleFocus:function(){var e=this;setTimeout(function(){e.isClick?e.isClick=!1:e.focusing=!0},50)},handleHeaderClick:function(){this.dispatch("ElCollapse","item-click",this),this.focusing=!1,this.isClick=!0},handleEnterClick:function(){this.dispatch("ElCollapse","item-click",this)}}},Ee={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"el-collapse-item",class:{"is-active":e.isActive}},[r("div",{attrs:{role:"tab","aria-expanded":e.isActive,"aria-controls":"el-collapse-content-"+e.id,"aria-describedby":"el-collapse-content-"+e.id}},[r("div",{staticClass:"el-collapse-item__header",class:{focusing:e.focusing,"is-active":e.isActive},attrs:{role:"button",id:"el-collapse-head-"+e.id,tabindex:"0"},on:{click:e.handleHeaderClick,focus:e.handleFocus,blur:function(t){e.focusing=!1}}},[r("i",{staticClass:"el-collapse-item__arrow el-icon-arrow-right",class:{"is-active":e.isActive}}),e._v(" "),e._t("title",[e._v(e._s(e.title))])],2)]),e._v(" "),r("el-collapse-transition",[r("div",{directives:[{name:"show",rawName:"v-show",value:e.isActive,expression:"isActive"}],staticClass:"el-collapse-item__wrap",attrs:{role:"tabpanel","aria-hidden":!e.isActive,"aria-labelledby":"el-collapse-head-"+e.id,id:"el-collapse-content-"+e.id}},[r("div",{staticClass:"el-collapse-item__content"},[e._t("default")],2)])])],1)},staticRenderFns:[]},Te=r("Z0/y")(Ae,Ee,!1,null,null,null).exports;o.default.component(Te.name,Te),o.default.use(Oe.a),o.default.use(ze.a),o.default.use(i.a),o.default.use(a.a),o.default.config.productionTip=!1,new o.default({el:"#app",router:Qe,store:f,components:{App:s},template:"<App/>"})},"Og/b":function(e,t){},RoUG:function(e,t){},"W+bB":function(e,t){},W4kt:function(e,t){},"a+yd":function(e,t){},cpDg:function(e,t){},dJdu:function(e,t){},gmNZ:function(e,t){},kp9x:function(e,t){},pZVs:function(e,t){},ri7w:function(e,t){}},["NHnr"]);
//# sourceMappingURL=app.eb0d1396eec92f0ebd2b.js.map